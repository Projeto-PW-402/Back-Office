import{N as z}from"./Navbar-WhxOcJwi.js";import{d as C,r as i,i as D,c as F,o as S,f as v,a as t,t as l,u as _,m as g}from"./index-Bph_iwWA.js";import{f as J,a as w}from"./auditoriasService-CUiB3gN0.js";import{a as O}from"./userService-BPWHVbBk.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"dashboard-container"},E={class:"information-container p-4"},L={class:"graphs-container"},T={class:"top"},P={class:"row top-left"},V={class:"box workers"},$={class:"box-counter"},I={class:"box totais"},R={class:"box-counter"},U={class:"box andamento"},W={class:"box-counter"},Y={class:"box finalizadas"},q={class:"box-counter"},G={class:"bottom"},H={class:"row bottom-left"},K={class:"row bottom-right"},Q=C({__name:"Dashboard",setup(X){const p=i([{name:"Auditorias",data:[]}]);i({chart:{id:"auditorias-chart",toolbar:{show:!1}},xaxis:{categories:["Jan","Fev","Mar","Abr","Mai","Jun","Jul"]},colors:["#008FFB"],dataLabels:{enabled:!1},stroke:{curve:"smooth"}});const f=i([]),h=i([]),m=i(0),b=i(0),d=i(0),c=i(0);async function x(o,s){try{const e=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${o}&lon=${s}`)).json();return e.address.city||e.address.town||e.address.village||"Desconhecido"}catch(r){return console.error("Erro no reverse geocoding",r),"Desconhecido"}}async function A(){const o=await O();m.value=o.length}async function y(){const o=await w();b.value=o.length,d.value=0,c.value=0;for(const s of o)s.status===1?d.value++:s.status===2&&c.value++}function k(o){const s=Array(12).fill(0);return o.forEach(({date:r})=>{if(!r)return;const[e]=r.split(" ");let a;if(e.includes("/")?a=e.split("/"):a=e.split("-"),a.length!==3)return;const[n,u,M]=a.map(Number);M===2025&&u>=1&&u<=12&&s[u-1]++}),s}const N=i({chart:{id:"auditorias-chart",toolbar:{show:!1}},xaxis:{categories:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},colors:["#008FFB"],dataLabels:{enabled:!1},stroke:{curve:"smooth"}});return D(async()=>{const o=await J(),s=[];for(const a of o){const n=await x(a.lat,a.lng);s.push(n)}const r=s.reduce((a,n)=>(a[n]=(a[n]||0)+1,a),{});h.value=Object.keys(r),f.value=Object.values(r);const e=await w();p.value[0].data=k(e),A(),y()}),(o,s)=>(S(),F("div",j,[v(z,{page:0}),t("div",E,[s[6]||(s[6]=t("h2",{class:"mb-4 fw-bold title"},"Dashboard",-1)),t("div",L,[t("div",T,[t("div",P,[t("div",V,[s[0]||(s[0]=t("div",{class:"box-title"},"Trabalhadores",-1)),t("div",$,l(m.value),1)]),t("div",I,[s[1]||(s[1]=t("div",{class:"box-title"},"Auditorias",-1)),t("div",R,l(b.value),1)]),t("div",U,[s[2]||(s[2]=t("div",{class:"box-title"},"Auditorias Em Andamento",-1)),t("div",W,l(d.value),1)]),t("div",Y,[s[3]||(s[3]=t("div",{class:"box-title"},"Auditorias Terminadas",-1)),t("div",q,l(c.value),1)])])]),t("div",G,[t("div",H,[s[4]||(s[4]=t("div",{class:"graph-title"},"Nº Auditorias por Região",-1)),v(_(g),{class:"graph",type:"pie",series:f.value,options:{labels:h.value,responsive:[{breakpoint:480,options:{legend:{position:"bottom",horizontalAlign:"center",floating:!1,offsetY:0,height:void 0,showForSingleSeries:!0,show:!0,fontSize:"16px",labels:{useSeriesColors:!0},markers:{width:12,height:12},itemMargin:{horizontal:10,vertical:5}}}}]},width:"550"},null,8,["series","options"])]),t("div",K,[s[5]||(s[5]=t("div",{class:"graph-title"},"Nº Auditorias por Mes",-1)),v(_(g),{class:"graph",type:"line",series:p.value,options:N.value,width:"550"},null,8,["series","options"])])])])])]))}}),es=B(Q,[["__scopeId","data-v-0aa86e77"]]);export{es as default};
