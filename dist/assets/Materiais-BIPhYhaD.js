var ne=Object.defineProperty;var re=(h,r,u)=>r in h?ne(h,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):h[r]=u;var C=(h,r,u)=>re(h,typeof r!="symbol"?r+"":r,u);import{c as K,N as de}from"./Navbar-DxcdHLe8.js";import{d as W,r as n,J as O,c as g,o as c,I as $,a as e,f as b,u as L,e as w,v as _,G as A,w as X,g as j,K as H,i as G,L as ue,l as S,y as I,p as ce,F as Q,E as J,H as T,D as x,M as pe,t as P,N as ve}from"./index-n0MpAePN.js";import{c as me,f as be,u as Y,a as fe}from"./materialService-EQM2v9Ok.js";import{X as Z}from"./x-DPV4mNUj.js";import{_ as R}from"./plugin-vueexport-helper-DlAUqK2U.js";import{T as ye}from"./trash-2-DCNymvDI.js";/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=K("diamond-plus",[["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41L13.7 2.71a2.41 2.41 0 0 0-3.41 0z",key:"1ey20j"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=K("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);class ae{constructor(r){C(this,"id",0);C(this,"nome","");C(this,"tipo","");C(this,"descricao","");C(this,"quant",0);C(this,"preco",0);C(this,"visible",!0);Object.assign(this,r)}}const he={class:"name-container"},ke={class:"middle-container"},Me={class:"tipo-container"},we={class:"quantidade-container"},_e={class:"preco-container"},qe={class:"descricao-container"},xe={type:"submit"},$e=W({__name:"NewMaterial",props:{visible:{type:Boolean}},emits:["material-added"],setup(h,{emit:r}){const u=h,k=n(u.visible),E=H(),N=j(),U=r,f=n(""),y=n(""),M=n(""),v=n(0),d=n(0);O(()=>{const V=E.query.add;k.value=V==="true"});async function z(){const V=new ae({nome:f.value,tipo:y.value,descricao:M.value,quant:v.value,preco:d.value});try{await me(V),U("material-added"),N.push({path:"/materiais"})}catch(l){console.error("Erro ao adicionar utilizador:",l)}}function q(){k.value=!1,N.push({path:"/materiais",query:{add:"false"}})}return(V,l)=>(c(),g("div",{class:"main-container",style:$({display:u.visible?"flex":"none"})},[l[11]||(l[11]=e("div",{class:"title"},"Adicionar Material",-1)),e("div",{class:"close",onClick:q},[b(L(Z))]),e("form",{id:"materialForm",onSubmit:X(z,["prevent"])},[e("div",he,[w(e("input",{type:"text",id:"name","onUpdate:modelValue":l[0]||(l[0]=i=>f.value=i),placeholder:""},null,512),[[_,f.value]]),l[5]||(l[5]=e("label",{class:"name-label",for:"name"},"Nome",-1))]),e("div",ke,[e("div",Me,[w(e("input",{type:"text",id:"tipo","onUpdate:modelValue":l[1]||(l[1]=i=>y.value=i),placeholder:""},null,512),[[_,y.value]]),l[6]||(l[6]=e("label",{class:"tipo-label",for:"tipo"},"Tipo",-1))]),e("div",we,[w(e("input",{type:"number",id:"quantidade","onUpdate:modelValue":l[2]||(l[2]=i=>v.value=i),placeholder:""},null,512),[[_,v.value]]),l[7]||(l[7]=e("label",{class:"quantidade-label",for:"quantidade"},"Quantidade",-1))])]),e("div",_e,[w(e("input",{type:"number",id:"preco","onUpdate:modelValue":l[3]||(l[3]=i=>d.value=i),placeholder:""},null,512),[[_,d.value]]),l[8]||(l[8]=e("label",{class:"preco-label",for:"preco"},"Preço",-1))]),e("div",qe,[w(e("input",{type:"text",id:"descricao","onUpdate:modelValue":l[4]||(l[4]=i=>M.value=i),placeholder:""},null,512),[[_,M.value]]),l[9]||(l[9]=e("label",{class:"descricao-label",for:"descricao"},"Descrição",-1))]),e("button",xe,[l[10]||(l[10]=A("Adicionar")),b(L(ee),{width:"22",height:"22"})])],32)],4))}}),Ve=R($e,[["__scopeId","data-v-745873d8"]]),Ce={class:"name-container"},Ee=["placeholder"],Ne={class:"middle-container"},Ue={class:"tipo-container"},ze=["placeholder"],Ie={class:"quantidade-container"},Pe=["placeholder"],Ae={class:"preco-container"},Be=["placeholder"],Le={class:"descricao-container"},De=["placeholder"],Te={type:"submit"},Fe=W({__name:"EditMaterial",props:{isModalVisible:{type:Boolean}},emits:["material-added","material-edited"],setup(h,{emit:r}){const u=h,k=n(u.isModalVisible),E=H(),N=j(),U=r,f=n(),y=n(),M=n(),v=n(),d=n(),z=n(!0);O(()=>{const i=Number(E.query.id),a=E.query.edit;k.value=a==="true",!isNaN(i)&&a==="true"&&q(i)});async function q(i){try{const a=await be(i);f.value=a.nome,y.value=a.tipo,M.value=a.descricao,v.value=a.quant,d.value=a.preco,z.value=a.visible,console.log("Material:",a)}catch(a){console.error("Erro ao buscar material:",a)}}async function V(){let i=z;if(v.value<0||d.value<0){alert("Quantidade e preço não podem ser negativos.");return}v.value===0&&(i.value=!1);const a=new ae({nome:f.value,tipo:y.value,descricao:M.value,quant:v.value,preco:d.value,visible:i.value});try{await Y(a.id,a),U("material-edited"),N.push({path:"/materiais"})}catch(m){console.error("Erro ao adicionar utilizador:",m)}}function l(){k.value=!1,N.push({path:"/materiais",query:{edit:"false"}})}return(i,a)=>(c(),g("div",{class:"main-container",style:$({display:u.isModalVisible?"flex":"none"})},[a[11]||(a[11]=e("div",{class:"title"},"Editar Material",-1)),e("div",{class:"close",onClick:l},[b(L(Z))]),e("form",{id:"materialForm",onSubmit:X(V,["prevent"])},[e("div",Ce,[w(e("input",{type:"text",id:"name","onUpdate:modelValue":a[0]||(a[0]=m=>f.value=m),placeholder:f.value},null,8,Ee),[[_,f.value]]),a[5]||(a[5]=e("label",{class:"name-label",for:"name"},"Nome",-1))]),e("div",Ne,[e("div",Ue,[w(e("input",{type:"text",id:"tipo","onUpdate:modelValue":a[1]||(a[1]=m=>y.value=m),placeholder:y.value},null,8,ze),[[_,y.value]]),a[6]||(a[6]=e("label",{class:"tipo-label",for:"tipo"},"Tipo",-1))]),e("div",Ie,[w(e("input",{type:"number",id:"quantidade","onUpdate:modelValue":a[2]||(a[2]=m=>v.value=m),placeholder:v.value},null,8,Pe),[[_,v.value]]),a[7]||(a[7]=e("label",{class:"quantidade-label",for:"quantidade"},"Quantidade",-1))])]),e("div",Ae,[w(e("input",{type:"number",id:"preco","onUpdate:modelValue":a[3]||(a[3]=m=>d.value=m),placeholder:d.value,step:"0.01"},null,8,Be),[[_,d.value,void 0,{number:!0}]]),a[8]||(a[8]=e("label",{class:"preco-label",for:"preco"},"Preço",-1))]),e("div",Le,[w(e("input",{type:"text",id:"descricao","onUpdate:modelValue":a[4]||(a[4]=m=>M.value=m),placeholder:M.value},null,8,De),[[_,M.value]]),a[9]||(a[9]=e("label",{class:"descricao-label",for:"descricao"},"Descrição",-1))]),e("button",Te,[a[10]||(a[10]=A("Update")),b(L(ee),{width:"22",height:"22"})])],32)],4))}}),Se=R(Fe,[["__scopeId","data-v-10f7ed56"]]),Qe={class:"container-fluid p-4 bg-light min-vh-100"},We={class:"table-responsive bg-white"},je={class:"table mb-0"},He={class:"text-center align-middle"},Re=["onClick"],Ge=["onClick"],Je={class:"pagination"},Ke={class:"pagination pagination-sm mb-0"},Oe={key:0,class:"page-item"},Xe={key:1,class:"page-item disabled"},Ye={key:1,class:"page-link active"},Ze={key:6,class:"page-item disabled"},ea={key:7,class:"page-item"},aa=W({__name:"Materiais",setup(h){const r=n([]),u=n(10),k=H(),E=j(),N=n(window.innerWidth),U=n(window.innerHeight);y(U.value);function f(){N.value=window.innerWidth,U.value=window.innerHeight}function y(t){t<864?u.value=5:t<956?u.value=7:u.value=10}G(()=>{window.addEventListener("resize",f)}),ue(()=>{window.removeEventListener("resize",f)}),S(U,t=>{y(t)}),I(()=>r.value.length===d.value.length);const M=I(()=>{const t=(i.value-1)*u.value;return d.value.slice(t,t+u.value)}),v=I(()=>{const t=k.query.page,s=Array.isArray(t)?t[0]:t;return parseInt(s||"1")}),d=n([]);let z;async function q(){d.value=await fe(),d.value.length===0?d.value=[]:console.log("Materiais carregados com sucesso:",d.value)}G(async()=>{await q(),console.log(d.value),z=window.setInterval(q,5e3)}),ce(()=>{clearInterval(z)});async function V(t){const s=t.id;t.visible=!1;try{await Y(s,t),await q(),console.log("Utilizador eliminado com sucesso:",s)}catch(p){console.error("Erro ao eliminar utilizador:",p)}}const l=I(()=>Math.ceil(d.value.length/u.value)),i=n(v.value),a=I(()=>{const t=[],s=Math.floor(2);let p=Math.max(i.value-s,1),o=p+4-1;o>l.value&&(o=l.value,p=Math.max(o-4,1));for(let D=p;D<=o;D++)t.push(D);return t});S(v,t=>{i.value=t,console.log("Current page:",t)});const m=I(()=>{const t=k.query.add;return!(t===void 0||t==="false")}),te=I(()=>{const t=k.query.edit;return!(t===void 0||t==="false")}),le=n(!1),ie=n(!1),B=n(m.value),F=n(te.value);console.log("isModalActive:",B.value),S(()=>k.query.add,t=>{B.value=t!=="false"&&t!==void 0}),S(()=>k.query.edit,t=>{F.value=t!=="false"&&t!==void 0});function se(){le.value=!0,B.value=!0,E.push({path:"/materiais",query:{add:"true"}})}function oe(t){ie.value=!0,F.value=!0,E.push({path:"/materiais",query:{edit:"true",id:t.id}})}return(t,s)=>{const p=pe("router-link");return c(),g(Q,null,[e("div",{class:"materiais-container",style:$({filter:B.value||F.value?"blur(5px)":"blur(0)"})},[b(de,{page:4,disable:B.value},null,8,["disable"]),e("div",Qe,[s[9]||(s[9]=e("h2",{class:"mb-4 fw-bold",id:"title"},"Materiais",-1)),e("div",We,[e("table",je,[s[0]||(s[0]=e("thead",{class:"text-center align-middle"},[e("tr",null,[e("th",{scope:"col"},"Nome"),e("th",{scope:"col"},"Tipo"),e("th",{scope:"col",id:"descricao"},"Descrição"),e("th",{scope:"col"},"Quantidade"),e("th",{scope:"col"},"Ação"),e("th",{scope:"col"},"Preço")])],-1)),e("tbody",He,[(c(!0),g(Q,null,J(M.value,o=>(c(),g("tr",{key:o.id},[e("td",{style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},P(o.nome),5),e("td",{style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},P(o.tipo),5),e("td",{style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},P(o.descricao),5),e("td",{style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},P(o.quant),5),e("td",{class:"actions-container",style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},[e("button",{class:"actions",style:{color:"red"},onClick:D=>V(o)},[b(L(ye),{width:"20px",height:"20px"})],8,Re),e("button",{class:"actions",style:{color:"orange"},onClick:D=>oe(o)},[b(L(ge),{width:"20px",height:"20px"})],8,Ge)],4),e("td",{style:$({backgroundColor:r.value.includes(o.id)?"lightblue":"white"})},P(o.preco)+" € ",5)]))),128))])])]),e("nav",Je,[e("ul",Ke,[i.value!=1?(c(),g("li",Oe,[b(p,{to:{path:"/materiais",query:{page:i.value-1}},class:"page-link"},{default:x(()=>s[1]||(s[1]=[e("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])):(c(),g("li",Xe,[b(p,{to:{path:"/materiais",query:{page:i.value-1}},class:"page-link"},{default:x(()=>s[2]||(s[2]=[e("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])),i.value!==1?(c(),T(p,{key:2,to:{path:"/materiais",query:{page:1}},class:"page-link"},{default:x(()=>s[3]||(s[3]=[A(" First ")])),_:1})):(c(),T(p,{key:3,to:{path:"/materiais",query:{page:1}},class:"page-link disabled"},{default:x(()=>s[4]||(s[4]=[A(" First ")])),_:1})),(c(!0),g(Q,null,J(a.value,o=>(c(),g("li",{key:o,class:ve(["page-item",{active:o===i.value}])},[o!==i.value?(c(),T(p,{key:0,to:{path:"/materiais",query:{page:o}},class:"page-link"},{default:x(()=>[A(P(o),1)]),_:2},1032,["to"])):(c(),g("span",Ye,P(o),1))],2))),128)),i.value!==l.value?(c(),T(p,{key:4,to:{path:"/materiais",query:{page:l.value}},class:"page-link"},{default:x(()=>s[5]||(s[5]=[A(" Last ")])),_:1},8,["to"])):(c(),T(p,{key:5,to:{path:"/materiais",query:{page:l.value}},class:"page-link disabled"},{default:x(()=>s[6]||(s[6]=[A(" Last ")])),_:1},8,["to"])),i.value==l.value?(c(),g("li",Ze,[b(p,{to:{path:"/materiais",query:{page:i.value+1}},class:"page-link"},{default:x(()=>s[7]||(s[7]=[e("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])])):(c(),g("li",ea,[b(p,{to:{path:"/materiais",query:{page:i.value+1}},class:"page-link"},{default:x(()=>s[8]||(s[8]=[e("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])]))])]),e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-warning",id:"adicionar",onClick:se}," Adicionar ")])])],4),b(Ve,{visible:B.value,onMaterialAdded:q},null,8,["visible"]),b(Se,{isModalVisible:F.value,onMaterialEdited:q},null,8,["isModalVisible"])],64)}}}),da=R(aa,[["__scopeId","data-v-54dee041"]]);export{da as default};
