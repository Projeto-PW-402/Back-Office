import{d as X,r as h,i as S,L as Z,l as L,y as b,K as J,p as O,c as i,o as s,f as r,a as o,e as Y,P as ee,Q as te,F as A,E as T,H as x,D as d,M as ae,I as k,G as c,u as g,t as w,N as oe,g as se}from"./index-Bph_iwWA.js";import{c as C,N as le}from"./Navbar-WhxOcJwi.js";import{a as ie,e as M,g as ne}from"./auditoriasService-CUiB3gN0.js";import{X as D}from"./x-zuvvmeHI.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=C("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=C("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=C("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=C("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),pe={class:"auditorias-container"},ve={class:"frame"},ge={class:"container-fluid p-4 bg-light",id:"table-container"},ye={class:"table-responsive bg-white"},he={class:"filtro-container"},ke={class:"table mb-0"},fe={class:"text-center align-middle"},me={key:0,style:{color:"orange"}},be={key:1,style:{color:"red"}},we={key:2,style:{color:"green"}},_e={key:3,style:{color:"gray"}},xe=["onClick"],Ce=["onClick"],Ee=["onClick"],Ae=["onClick"],Me={key:2,class:"actions",style:{color:"gray",fontSize:"20px"}},qe=["onClick"],Ne={class:"pagination"},ze={class:"pagination pagination-sm mb-0"},Fe={key:0,class:"page-item"},Ie={key:1,class:"page-item disabled"},Pe={key:1,class:"page-link active"},Se={key:6,class:"page-item disabled"},Le={key:7,class:"page-item"},Te=X({__name:"Pedidos",setup(De){const p=h([]),f=h(10),y=h("todas"),H=J(),V=se(),$=h(window.innerWidth),E=h(window.innerHeight);z(E.value);function N(){$.value=window.innerWidth,E.value=window.innerHeight}function z(t){t<864?f.value=8:(t<956,f.value=10)}S(()=>{window.addEventListener("resize",N)}),Z(()=>{window.removeEventListener("resize",N)}),L(E,t=>{z(t)}),b(()=>p.value.length===u.value.length);const B=b(()=>{const t=(n.value-1)*f.value;return P.value.slice(t,t+f.value)}),m=b(()=>Math.ceil(P.value.length/f.value)),F=b(()=>{const t=H.query.page,e=Array.isArray(t)?t[0]:t;return parseInt(e||"1")}),u=h([]);let I;async function _(){u.value=await ie(),u.value.length===0?u.value=[]:console.log("Auditorias carregadas com sucesso:",u.value)}const P=b(()=>y.value==="todas"?u.value:y.value==="em_espera"?u.value.filter(t=>t.status===0):y.value==="aceite"?u.value.filter(t=>t.status===1):y.value==="terminada"?u.value.filter(t=>t.status===2):y.value==="rejeitada"?u.value.filter(t=>t.status===-1):u.value);S(async()=>{await _(),console.log(u.value),I=window.setInterval(_,5e3)}),O(()=>{clearInterval(I)});const n=h(F.value),U=b(()=>{const t=[],e=Math.floor(2);let l=Math.max(n.value-e,1),a=l+4-1;a>m.value&&(a=m.value,l=Math.max(a-4,1));for(let v=l;v<=a;v++)t.push(v);return t});L(F,t=>{n.value=t,console.log("Current page:",t)});function R(t){console.log("Auditoria ID:",t),V.push({path:`pedidos/config/${t}`})}async function j(t,e){e.status=-1;try{await M(t,e),await _(),console.log("Utilizador eliminado com sucesso:",t)}catch(l){console.error("Erro ao eliminar utilizador:",l)}}async function W(t,e){e.status=0;try{await M(t,e),await _(),console.log("Estado:",t)}catch(l){console.error("Erro ao editar Estado:",l)}}async function G(t,e){e.status=2;try{await M(t,e),await _(),console.log("Estado:",t)}catch(l){console.error("Erro ao editar Estado:",l)}}async function K(t){try{await ne(t)}catch(e){console.error("Erro ao editar Estado:",e)}}function Q(t){switch(t){case 0:return"Sem Nivel Atribuido";default:return t}}return(t,e)=>{const l=ae("router-link");return s(),i("div",pe,[r(le,{page:3}),o("div",ve,[o("div",ge,[e[17]||(e[17]=o("h2",{class:"mb-4 fw-bold",id:"title"},"Auditorias",-1)),o("div",ye,[o("div",he,[e[2]||(e[2]=o("label",{for:"filtroEstado"},"Filtar",-1)),Y(o("select",{id:"filtroEstado","onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a)},e[1]||(e[1]=[te('<option value="todas" data-v-877b3a23>Todas</option><option value="em_espera" data-v-877b3a23>Em Espera</option><option value="aceite" data-v-877b3a23>Aceite</option><option value="terminada" data-v-877b3a23>Terminada</option><option value="rejeitada" data-v-877b3a23>Não Aceites</option>',5)]),512),[[ee,y.value]])]),o("table",ke,[e[8]||(e[8]=o("thead",{class:"text-center align-middle"},[o("tr",null,[o("th",{scope:"col"},"Estado"),o("th",{scope:"col"},"Nivel de Risco"),o("th",{scope:"col"},"Utilizador"),o("th",{scope:"col"},"Local"),o("th",{scope:"col"},"Data"),o("th",{scope:"col"},"Ação"),o("th",{scope:"col"},"Documento")])],-1)),o("tbody",fe,[(s(!0),i(A,null,T(B.value,a=>(s(),i("tr",{key:a.id},[o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},[a.status===0?(s(),i("p",me,[e[3]||(e[3]=c(" Em Análise ")),r(g(de))])):a.status===-1?(s(),i("p",be,[e[4]||(e[4]=c("Recusado ")),r(g(D))])):a.status===1?(s(),i("p",we,[e[5]||(e[5]=c(" Aceite ")),r(g(q))])):(s(),i("p",_e,[e[6]||(e[6]=c("Terminado ")),r(g(q))]))],4),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},w(Q(a.risco)),5),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},w(a.nome),5),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},w(a.location),5),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},w(a.date),5),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},[a.status!==1&&a.status!==2?(s(),i(A,{key:0},[o("button",{onClick:v=>R(a.id),class:"actions",style:{color:"green"}},[r(g(q),{width:"20px",height:"20px"})],8,xe),o("button",{onClick:v=>j(a.id,a),class:"actions",style:{color:"red"}},[r(g(D),{width:"20px",height:"20px"})],8,Ce),o("button",{onClick:v=>W(a.id,a),class:"actions",style:{color:"yellow"}},[r(g(ce),{width:"20px",height:"20px"})],8,Ee)],64)):a.status===1?(s(),i("button",{key:1,onClick:v=>G(a.id,a),class:"actions",style:{color:"red",fontSize:"20px"}}," Terminar ",8,Ae)):(s(),i("button",Me," No Actions "))],4),o("td",{style:k({backgroundColor:p.value.includes(a.id)?"lightblue":"white"})},[o("button",{class:"download",onClick:v=>K(a.id)},[e[7]||(e[7]=c(" Download ")),r(g(ue),{width:"20px",height:"20px"})],8,qe)],4)]))),128))])])]),o("nav",Ne,[o("ul",ze,[n.value!=1?(s(),i("li",Fe,[r(l,{to:{path:"/auditorias/pedidos",query:{page:n.value-1}},class:"page-link"},{default:d(()=>e[9]||(e[9]=[o("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])):(s(),i("li",Ie,[r(l,{to:{path:"/auditorias/pedidos",query:{page:n.value-1}},class:"page-link"},{default:d(()=>e[10]||(e[10]=[o("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])),n.value!==1?(s(),x(l,{key:2,to:{path:"/auditorias/pedidos",query:{page:1}},class:"page-link"},{default:d(()=>e[11]||(e[11]=[c(" First ")])),_:1})):(s(),x(l,{key:3,to:{path:"/auditorias/pedidos",query:{page:1}},class:"page-link disabled"},{default:d(()=>e[12]||(e[12]=[c(" First ")])),_:1})),(s(!0),i(A,null,T(U.value,a=>(s(),i("li",{key:a,class:oe(["page-item",{active:a===n.value}])},[a!==n.value?(s(),x(l,{key:0,to:{path:"/auditorias/pedidos",query:{page:a}},class:"page-link"},{default:d(()=>[c(w(a),1)]),_:2},1032,["to"])):(s(),i("span",Pe,w(a),1))],2))),128)),n.value!==m.value?(s(),x(l,{key:4,to:{path:"/auditorias/pedidos",query:{page:m.value}},class:"page-link"},{default:d(()=>e[13]||(e[13]=[c(" Last ")])),_:1},8,["to"])):(s(),x(l,{key:5,to:{path:"/auditorias/pedidos",query:{page:m.value}},class:"page-link disabled"},{default:d(()=>e[14]||(e[14]=[c(" Last ")])),_:1},8,["to"])),n.value==m.value?(s(),i("li",Se,[r(l,{to:{path:"/auditorias/pedidos",query:{page:n.value+1}},class:"page-link"},{default:d(()=>e[15]||(e[15]=[o("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])])):(s(),i("li",Le,[r(l,{to:{path:"/auditorias/pedidos",query:{page:n.value+1}},class:"page-link"},{default:d(()=>e[16]||(e[16]=[o("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])]))])])])])])}}}),Re=re(Te,[["__scopeId","data-v-877b3a23"]]);export{Re as default};
