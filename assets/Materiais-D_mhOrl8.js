var ne=Object.defineProperty;var re=(g,r,u)=>r in g?ne(g,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):g[r]=u;var N=(g,r,u)=>re(g,typeof r!="symbol"?r+"":r,u);import{c as O,N as de}from"./Navbar-CFcv24k0.js";import{d as j,r as n,J as X,c as f,o as c,I as C,a as e,f as m,u as D,e as _,v as x,G as B,w as Y,g as H,K as R,i as J,L as ue,l as Q,y as P,p as ce,F as W,E as K,H as F,D as V,M as pe,t as A,N as ve}from"./index-DXanHhjz.js";import{c as me,f as be,u as Z,a as ye}from"./materialService-BNbF2-xw.js";import{X as ee}from"./x-wE9q6DMA.js";import{_ as G}from"./plugin-vueexport-helper-DlAUqK2U.js";import{T as fe}from"./trash-2-CmnOKcjk.js";/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=O("diamond-plus",[["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41L13.7 2.71a2.41 2.41 0 0 0-3.41 0z",key:"1ey20j"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-vue-next v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=O("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);class ae{constructor(r){N(this,"id",0);N(this,"nome","");N(this,"tipo","");N(this,"descricao","");N(this,"quant",0);N(this,"preco",0);N(this,"visible",!0);Object.assign(this,r)}}const he={class:"name-container"},ke={class:"middle-container"},Me={class:"tipo-container"},we={class:"quantidade-container"},qe={class:"preco-container"},_e={class:"descricao-container"},xe={type:"submit"},$e=j({__name:"NewMaterial",props:{visible:{type:Boolean}},emits:["material-added"],setup(g,{emit:r}){const u=g,h=n(u.visible),U=R(),z=H(),I=r,$=n(""),b=n(""),k=n(""),y=n(0),d=n(0);X(()=>{const E=U.query.add;h.value=E==="true"});async function M(){const E=new ae({nome:$.value,tipo:b.value,descricao:k.value,quant:y.value,preco:d.value});try{await me(E),I("material-added"),z.push({path:"/materiais"})}catch(l){console.error("Erro ao adicionar utilizador:",l)}}function q(){h.value=!1,z.push({path:"/materiais",query:{add:"false"}})}return(E,l)=>(c(),f("div",{class:"main-container",style:C({display:u.visible?"flex":"none"})},[l[11]||(l[11]=e("div",{class:"title"},"Adicionar Material",-1)),e("div",{class:"close",onClick:q},[m(D(ee))]),e("form",{id:"materialForm",onSubmit:Y(M,["prevent"])},[e("div",he,[_(e("input",{type:"text",id:"name","onUpdate:modelValue":l[0]||(l[0]=o=>$.value=o),placeholder:""},null,512),[[x,$.value]]),l[5]||(l[5]=e("label",{class:"name-label",for:"name"},"Nome",-1))]),e("div",ke,[e("div",Me,[_(e("input",{type:"text",id:"tipo","onUpdate:modelValue":l[1]||(l[1]=o=>b.value=o),placeholder:""},null,512),[[x,b.value]]),l[6]||(l[6]=e("label",{class:"tipo-label",for:"tipo"},"Tipo",-1))]),e("div",we,[_(e("input",{type:"number",id:"quantidade","onUpdate:modelValue":l[2]||(l[2]=o=>y.value=o),placeholder:""},null,512),[[x,y.value]]),l[7]||(l[7]=e("label",{class:"quantidade-label",for:"quantidade"},"Quantidade",-1))])]),e("div",qe,[_(e("input",{type:"number",id:"preco","onUpdate:modelValue":l[3]||(l[3]=o=>d.value=o),placeholder:""},null,512),[[x,d.value]]),l[8]||(l[8]=e("label",{class:"preco-label",for:"preco"},"Preço",-1))]),e("div",_e,[_(e("input",{type:"text",id:"descricao","onUpdate:modelValue":l[4]||(l[4]=o=>k.value=o),placeholder:""},null,512),[[x,k.value]]),l[9]||(l[9]=e("label",{class:"descricao-label",for:"descricao"},"Descrição",-1))]),e("button",xe,[l[10]||(l[10]=B("Adicionar")),m(D(te),{width:"22",height:"22"})])],32)],4))}}),Ve=G($e,[["__scopeId","data-v-745873d8"]]),Ce={class:"name-container"},Ee=["placeholder"],Ne={class:"middle-container"},Ue={class:"tipo-container"},ze=["placeholder"],Ie={class:"quantidade-container"},Pe=["placeholder"],Ae={class:"preco-container"},Be=["placeholder"],Le={class:"descricao-container"},De=["placeholder"],Te={type:"submit"},Fe=j({__name:"EditMaterial",props:{isModalVisible:{type:Boolean}},emits:["material-added","material-edited"],setup(g,{emit:r}){const u=g,h=n(u.isModalVisible),U=R(),z=H(),I=r,$=n(),b=n(),k=n(),y=n(),d=n(),M=n(),q=n(!0);X(()=>{const w=Number(U.query.id);$.value=w;const t=U.query.edit;h.value=t==="true",!isNaN(w)&&t==="true"&&E(w)});async function E(w){try{const t=await be(w);b.value=t.nome,k.value=t.tipo,y.value=t.descricao,d.value=t.quant,M.value=t.preco,q.value=t.visible,console.log("Material:",t)}catch(t){console.error("Erro ao buscar material:",t)}}async function l(){let w=q;if(d.value<0||M.value<0){alert("Quantidade e preço não podem ser negativos.");return}d.value===0&&(w.value=!1);const t=new ae({nome:b.value,tipo:k.value,descricao:y.value,quant:d.value,preco:M.value,visible:w.value});try{await Z($.value,t),I("material-edited"),z.push({path:"/materiais"})}catch(v){console.error("Erro ao adicionar utilizador:",v)}}function o(){h.value=!1,z.push({path:"/materiais",query:{edit:"false"}})}return(w,t)=>(c(),f("div",{class:"main-container",style:C({display:u.isModalVisible?"flex":"none"})},[t[12]||(t[12]=e("div",{class:"title"},"Editar Material",-1)),e("div",{class:"close",onClick:o},[m(D(ee))]),e("form",{id:"materialForm",onSubmit:t[5]||(t[5]=Y(v=>l(),["prevent"]))},[e("div",Ce,[_(e("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=v=>b.value=v),placeholder:b.value},null,8,Ee),[[x,b.value]]),t[6]||(t[6]=e("label",{class:"name-label",for:"name"},"Nome",-1))]),e("div",Ne,[e("div",Ue,[_(e("input",{type:"text",id:"tipo","onUpdate:modelValue":t[1]||(t[1]=v=>k.value=v),placeholder:k.value},null,8,ze),[[x,k.value]]),t[7]||(t[7]=e("label",{class:"tipo-label",for:"tipo"},"Tipo",-1))]),e("div",Ie,[_(e("input",{type:"number",id:"quantidade","onUpdate:modelValue":t[2]||(t[2]=v=>d.value=v),placeholder:d.value},null,8,Pe),[[x,d.value]]),t[8]||(t[8]=e("label",{class:"quantidade-label",for:"quantidade"},"Quantidade",-1))])]),e("div",Ae,[_(e("input",{type:"number",id:"preco","onUpdate:modelValue":t[3]||(t[3]=v=>M.value=v),placeholder:M.value,step:"0.01"},null,8,Be),[[x,M.value,void 0,{number:!0}]]),t[9]||(t[9]=e("label",{class:"preco-label",for:"preco"},"Preço",-1))]),e("div",Le,[_(e("input",{type:"text",id:"descricao","onUpdate:modelValue":t[4]||(t[4]=v=>y.value=v),placeholder:y.value},null,8,De),[[x,y.value]]),t[10]||(t[10]=e("label",{class:"descricao-label",for:"descricao"},"Descrição",-1))]),e("button",Te,[t[11]||(t[11]=B("Update")),m(D(te),{width:"22",height:"22"})])],32)],4))}}),Se=G(Fe,[["__scopeId","data-v-5711f2dd"]]),Qe={class:"container-fluid p-4 bg-light min-vh-100"},We={class:"table-responsive bg-white"},je={class:"table mb-0"},He={class:"text-center align-middle"},Re=["onClick"],Ge=["onClick"],Je={class:"pagination"},Ke={class:"pagination pagination-sm mb-0"},Oe={key:0,class:"page-item"},Xe={key:1,class:"page-item disabled"},Ye={key:1,class:"page-link active"},Ze={key:6,class:"page-item disabled"},et={key:7,class:"page-item"},tt=j({__name:"Materiais",setup(g){const r=n([]),u=n(10),h=R(),U=H(),z=n(window.innerWidth),I=n(window.innerHeight);b(I.value);function $(){z.value=window.innerWidth,I.value=window.innerHeight}function b(a){a<864?u.value=5:a<956?u.value=7:u.value=10}J(()=>{window.addEventListener("resize",$)}),ue(()=>{window.removeEventListener("resize",$)}),Q(I,a=>{b(a)}),P(()=>r.value.length===d.value.length);const k=P(()=>{const a=(o.value-1)*u.value;return d.value.slice(a,a+u.value)}),y=P(()=>{const a=h.query.page,i=Array.isArray(a)?a[0]:a;return parseInt(i||"1")}),d=n([]);let M;async function q(){d.value=await ye(),d.value.length===0?d.value=[]:console.log("Materiais carregados com sucesso:",d.value)}J(async()=>{await q(),console.log(d.value),M=window.setInterval(q,5e3)}),ce(()=>{clearInterval(M)});async function E(a){const i=a.id;a.visible=!1;try{await Z(i,a),await q(),console.log("Utilizador eliminado com sucesso:",i)}catch(p){console.error("Erro ao eliminar utilizador:",p)}}const l=P(()=>Math.ceil(d.value.length/u.value)),o=n(y.value),w=P(()=>{const a=[],i=Math.floor(2);let p=Math.max(o.value-i,1),s=p+4-1;s>l.value&&(s=l.value,p=Math.max(s-4,1));for(let T=p;T<=s;T++)a.push(T);return a});Q(y,a=>{o.value=a,console.log("Current page:",a)});const t=P(()=>{const a=h.query.add;return!(a===void 0||a==="false")}),v=P(()=>{const a=h.query.edit;return!(a===void 0||a==="false")}),le=n(!1),ie=n(!1),L=n(t.value),S=n(v.value);console.log("isModalActive:",L.value),Q(()=>h.query.add,a=>{L.value=a!=="false"&&a!==void 0}),Q(()=>h.query.edit,a=>{S.value=a!=="false"&&a!==void 0});function se(){le.value=!0,L.value=!0,U.push({path:"/materiais",query:{add:"true"}})}function oe(a){ie.value=!0,S.value=!0,U.push({path:"/materiais",query:{edit:"true",id:a.id}})}return(a,i)=>{const p=pe("router-link");return c(),f(W,null,[e("div",{class:"materiais-container",style:C({filter:L.value||S.value?"blur(5px)":"blur(0)"})},[m(de,{page:4,disable:L.value},null,8,["disable"]),e("div",Qe,[i[9]||(i[9]=e("h2",{class:"mb-4 fw-bold",id:"title"},"Materiais",-1)),e("div",We,[e("table",je,[i[0]||(i[0]=e("thead",{class:"text-center align-middle"},[e("tr",null,[e("th",{scope:"col"},"Nome"),e("th",{scope:"col"},"Tipo"),e("th",{scope:"col",id:"descricao"},"Descrição"),e("th",{scope:"col"},"Quantidade"),e("th",{scope:"col"},"Ação"),e("th",{scope:"col"},"Preço")])],-1)),e("tbody",He,[(c(!0),f(W,null,K(k.value,s=>(c(),f("tr",{key:s.id},[e("td",{style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},A(s.nome),5),e("td",{style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},A(s.tipo),5),e("td",{style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},A(s.descricao),5),e("td",{style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},A(s.quant),5),e("td",{class:"actions-container",style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},[e("button",{class:"actions",style:{color:"red"},onClick:T=>E(s)},[m(D(fe),{width:"20px",height:"20px"})],8,Re),e("button",{class:"actions",style:{color:"orange"},onClick:T=>oe(s)},[m(D(ge),{width:"20px",height:"20px"})],8,Ge)],4),e("td",{style:C({backgroundColor:r.value.includes(s.id)?"lightblue":"white"})},A(s.preco)+" € ",5)]))),128))])])]),e("nav",Je,[e("ul",Ke,[o.value!=1?(c(),f("li",Oe,[m(p,{to:{path:"/materiais",query:{page:o.value-1}},class:"page-link"},{default:V(()=>i[1]||(i[1]=[e("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])):(c(),f("li",Xe,[m(p,{to:{path:"/materiais",query:{page:o.value-1}},class:"page-link"},{default:V(()=>i[2]||(i[2]=[e("span",{class:"page-link",id:"prev"},"<<Prev",-1)])),_:1},8,["to"])])),o.value!==1?(c(),F(p,{key:2,to:{path:"/materiais",query:{page:1}},class:"page-link"},{default:V(()=>i[3]||(i[3]=[B(" First ")])),_:1})):(c(),F(p,{key:3,to:{path:"/materiais",query:{page:1}},class:"page-link disabled"},{default:V(()=>i[4]||(i[4]=[B(" First ")])),_:1})),(c(!0),f(W,null,K(w.value,s=>(c(),f("li",{key:s,class:ve(["page-item",{active:s===o.value}])},[s!==o.value?(c(),F(p,{key:0,to:{path:"/materiais",query:{page:s}},class:"page-link"},{default:V(()=>[B(A(s),1)]),_:2},1032,["to"])):(c(),f("span",Ye,A(s),1))],2))),128)),o.value!==l.value?(c(),F(p,{key:4,to:{path:"/materiais",query:{page:l.value}},class:"page-link"},{default:V(()=>i[5]||(i[5]=[B(" Last ")])),_:1},8,["to"])):(c(),F(p,{key:5,to:{path:"/materiais",query:{page:l.value}},class:"page-link disabled"},{default:V(()=>i[6]||(i[6]=[B(" Last ")])),_:1},8,["to"])),o.value==l.value?(c(),f("li",Ze,[m(p,{to:{path:"/materiais",query:{page:o.value+1}},class:"page-link"},{default:V(()=>i[7]||(i[7]=[e("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])])):(c(),f("li",et,[m(p,{to:{path:"/materiais",query:{page:o.value+1}},class:"page-link"},{default:V(()=>i[8]||(i[8]=[e("span",{class:"page-link",id:"next"},"Next >>",-1)])),_:1},8,["to"])]))])]),e("div",{class:"text-end mt-3"},[e("button",{type:"button",class:"btn btn-warning",id:"adicionar",onClick:se}," Adicionar ")])])],4),m(Ve,{visible:L.value,onMaterialAdded:q},null,8,["visible"]),m(Se,{isModalVisible:S.value,onMaterialEdited:q},null,8,["isModalVisible"])],64)}}}),dt=G(tt,[["__scopeId","data-v-54dee041"]]);export{dt as default};
